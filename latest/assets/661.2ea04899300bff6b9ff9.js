/*! For license information please see 661.2ea04899300bff6b9ff9.js.LICENSE.txt */
"use strict";(self.webpackChunkmetanno=self.webpackChunkmetanno||[]).push([[228,661,848],{7494(n,e,t){t.d(e,{A:()=>i});var o=t(6314),r=t.n(o)()(function(n){return n[1]});r.push([n.id,"@import url(//fonts.googleapis.com/css?family=Roboto+Mono&display=swap);"]),r.push([n.id,"@import url(//cdn.jsdelivr.net/npm/hack-font@3/build/web/hack.css);"]),r.push([n.id,".metanno-text-view:focus-visible {\n    outline: none;\n}\n\n.metanno-text-view .text {\n    /*background: var(--metanno-background-color);*/\n    font-family: var(--metanno-font-family);\n    font-size: var(--metanno-font-size);\n    padding-top: 10px;\n    padding-bottom: 5px;\n    line-height: 2.8em;\n    color: var(--metanno-color);\n    position: relative;\n\n    width: 100%;\n    overflow-x: hidden;\n    -webkit-font-smoothing: antialiased;\n}\n\n.metanno-text-view .line {\n    padding-left: 41px;\n    box-sizing: border-box;\n    width: 100%;\n    contain: layout paint style;\n    transform: translateZ(0);\n    will-change: transform;\n}\n\n.metanno-text-view .line-number {\n    margin-left: -41px;\n    width: 0;\n    display: inline-block;\n    padding: 0 30px 0 11px;\n    color: #959da5;\n    white-space: nowrap;\n}\n\n.metanno-text-view .line-number,\n.metanno-text-view .label {\n    -webkit-touch-callout: none; /* iOS Safari */\n    -webkit-user-select: none; /* Safari */\n    -khtml-user-select: none; /* Konqueror HTML */\n    -moz-user-select: none; /* Old versions of Firefox */\n    -ms-user-select: none; /* Internet Explorer/Edge */\n    user-select: none; /* Non-prefixed version, currently supported by Chrome, Opera and Firefox */\n}\n\n.metanno-text-view .text-chunk {\n    word-break: break-word;\n    white-space: nowrap;\n    position: relative;\n    contain: layout paint;\n}\n\n.metanno-text-view .text-chunk-content {\n    position: relative;\n    z-index: 1001;\n    white-space: pre-wrap;\n}\n\n.metanno-text-view .mention_token {\n    box-sizing: content-box;\n    border-radius: 0.0000001em;\n    display: inline-block;\n\n    pointer-events: none;\n    position: absolute;\n    background-color: var(--metanno-background-color);\n    border-color: var(--metanno-border-color);\n    left: 0px;\n    right: 0px;\n    border-width: 2px;\n    border-style: solid;\n    border-right-width: 0;\n    border-left-width: 0;\n}\n\n.metanno-text-view .label {\n    box-sizing: content-box;\n    position: absolute;\n    white-space: pre;\n    border-radius: 0.2em;\n    font-size: 0.65em;\n    padding: 0.5em 0.1em 0em;\n    background: var(--metanno-background-color);\n    line-height: 0em;\n    height: 0.4em;\n    pointer-events: none;\n    color: var(--metanno-color);\n    border: 2px solid;\n    border-color: var(--metanno-color);\n}\n\n.metanno-text-view .label.highlighted {\n    outline: 2px solid #e7c600;\n    box-shadow: none;\n}\n\n.metanno-text-view .mention_token.mention_underline, .metanno-text-view .mention_token.mention_underline.closed_left, .metanno-text-view .mention_token.mention_underline.closed_right {\n    top: calc(100% - 3px);\n    border-top: 0;\n    border-top-left-radius: 0;\n    border-top-right-radius: 0;\n}\n\n.metanno-text-view .mention_token.closedleft {\n    left: -1px;\n    border-left-width: 2px;\n    border-top-left-radius: 2px;\n    border-bottom-left-radius: 2px;\n}\n\n.metanno-text-view .mention_token.closedright {\n    right: -1px;\n    border-right-width: 2px;\n    border-top-right-radius: 2px;\n    border-bottom-right-radius: 2px;\n}\n\n.metanno-text-view .mention_token.highlighted {\n    border-top-width: 4px;\n    border-bottom-width: 4px;\n}\n\n.metanno-text-view .mention_token.mention_underline, .metanno-text-view .mention_token.closedright.mention_underline, .metanno-text-view .mention_token.closedleft.mention_underline {\n    right: -2px;\n    border-top: 0;\n    border-top-left-radius: 0;\n    border-top-right-radius: 0;\n}\n\n.metanno-text-view .mention_token.closedleft.highlighted {\n    border-left-width: 4px;\n    left: -2px;\n}\n\n.metanno-text-view .mention_token.closedright.highlighted {\n    border-right-width: 4px;\n    right: -2px;\n}\n\n.metanno-text-view .mouse_selected {\n    background: rgba(137, 188, 250, 0.6); /*#b2d7ff88;*/\n    border: none;\n    min-height: 2.8em;\n    z-index: 1000;\n}\n\n/* Style only for Mozilla Firefox */\n@-moz-document url-prefix() {\n    .metanno-text-view .mouse_selected {\n        top: 0;\n        bottom: 0;\n        min-height: unset;\n    }\n}\n\n@keyframes blink {\n    from, to {\n        border-color: white\n    }\n    50% {\n        border-color: black\n    }\n}\n\n@media (prefers-reduced-motion: no-preference) {\n    .metanno-text-view .mention_token.selected {\n        animation: var(--blink-animation);\n    }\n}\n",""]);const i=r},2375(n,e,t){t.d(e,{A:()=>i});var o=t(6314),r=t.n(o)()(function(n){return n[1]});r.push([n.id,".rdg-checkbox-container {\n    display: flex;\n    height: 100%;\n    align-items: center;\n    justify-content: center;\n}\n\n.rdg-checkbox-container > .rdg-checkbox-label {\n    position: relative;\n}\n",""]);const i=r},3105(n,e,t){t.d(e,{A:()=>i});var o=t(6314),r=t.n(o)()(function(n){return n[1]});r.push([n.id,".metanno-table .react-autosuggest__container, .metanno-table  .input-tag-container {\n    position: relative;\n    height: 100%;\n    margin: 0 auto;\n    display: flex;\n    align-items: center;\n}\n\n.rdg-cell.rdg-editor-container > div > .react-autosuggest__container {\n    padding-left: 8px;\n    padding-right: 8px;\n    background: transparent;\n    margin-right: 0px;\n    box-sizing: border-box;\n}\n\n.rdg-cell .react-autosuggest__input {\n    font-family: inherit;\n    border: none;\n    font-size: var(--font-size);\n    width: 100%;\n    height: 100%;\n    color: var(--color);\n    background: transparent;\n}\n\n.rdg-cell .react-autosuggest__input::-ms-clear {\n    display: none;\n}\n\n.rdg-cell .react-autosuggest__input--open {\n    border-bottom-left-radius: 0;\n    border-bottom-right-radius: 0;\n}\n\n.rdg-cell .react-autosuggest__input--focused {\n    outline: none;\n}\n\n.rdg-cell .react-autosuggest__suggestions-container {\n    display: none;\n}\n\n.rdg-cell.rdg-editor-container > div {\n    /*background: white;*/\n}\n\n.rdg-editor-container > div, .metanno-table .rdg-cell-value, .rdg-cell-value > div {\n    height: 100%;\n    width: 100%;\n}\n\n.rdg-editor-container > div > .react-autosuggest__container--open > .react-autosuggest__suggestions-container {\n    left: -1px;\n    right: 0px;\n    box-shadow: inset 0 0 0 2px var(--selection-color)\n}\n\n.rdg-cell .react-autosuggest__suggestions-container--open {\n    display: block;\n    position: absolute;\n    top: 100%;\n    min-width: 100%;\n    box-sizing: border-box;\n    border: 1px solid var(--border-color, #aaa);\n    background-color: var(--background-color, white);\n    /* font-family: 'Open Sans', sans-serif;\n    font-weight: 300;\n    font-size: 14px;*/\n    border-bottom-left-radius: 4PX;\n    border-bottom-right-radius: 4PX;\n    z-index: 2;\n    max-height: 200px;\n    overflow-y: auto;\n\n    overflow-y: scroll;\n    scrollbar-width: none; /* Firefox */\n    -ms-overflow-style: none; /* Internet Explorer 10+ */\n}\n\n.rdg-cell .react-autosuggest__suggestions-container--open::-webkit-scrollbar {\n    width: 0;\n    height: 0;\n}\n\n.rdg-cell .react-autosuggest__suggestions-list {\n    margin: 0;\n    padding: 0;\n    list-style-type: none;\n}\n\n.rdg-cell ul.react-autosuggest__suggestions-list {\n    margin-left: 0;\n}\n\n.rdg-cell ul > li.react-autosuggest__suggestion {\n    cursor: pointer;\n    padding: 0 6px;\n    margin-left: 2px;\n    margin-right: 2px;\n    margin-bottom: 0;\n    color: #106ba3;\n}\n\n.rdg-cell .react-autosuggest__suggestion--highlighted {\n    background-color: var(--row-hover-background-color, #ddd);\n}\n\n.rdg-cell .react-autosuggest__section-container {\n    border-top: 1px dashed #ccc;\n}\n\n.rdg-cell .react-autosuggest__section-container-first {\n    border-top: 0;\n}\n\n.rdg-cell .react-autosuggest__section-title {\n    padding: 10px 0 0 10px;\n    font-size: 12px;\n    color: #777;\n}\n\ndiv.input-tag {\n    display: flex;\n    flex-wrap: nowrap;\n    width: 100%;\n    /*padding: 2px;*/\n}\n\ndiv.input-tag input {\n    border: none;\n    width: 100%;\n    border-radius: 4PX;\n    -webkit-appearance: none;\n}\n\ndiv.input-tag input:focus {\n    outline: none;\n}\n\ndiv.input-tag > ul.input-tag__tags {\n    display: inline-flex;\n    flex-wrap: nowrap;\n    /*padding: 0 2px;*/\n    padding: 2px 8px;\n    margin: 0px -8px;\n    width: 100%;\n    overflow: scroll;\n    -ms-overflow-style: none;\n}\n\n/* Hide scrollbar for Chrome, Safari and Opera */\ndiv.input-tag > ul.input-tag__tags::-webkit-scrollbar {\n  display: none;\n}\n\n/* Hide scrollbar for IE and Edge */\n.example {\n}\n\ndiv.input-tag > ul.input-tag__tags > li {\n    align-items: center;\n    background: white;\n    border-radius: 2px;\n    color: black;\n    display: flex;\n    font-size: 14px;\n    line-height: 15px;\n    font-weight: 300;\n    list-style: none;\n    margin: 0 2px 0 0;\n    padding: 1px 5px;\n    position: relative;\n}\n\ndiv.input-tag > ul.input-tag__tags > li button {\n    align-items: center;\n    appearance: none;\n    background: #333333;\n    border: none;\n    border-radius: 50%;\n    color: white;\n    cursor: pointer;\n    display: inline-flex;\n    font-size: 10px;\n    height: 15px;\n    justify-content: center;\n    line-height: 0;\n    margin-left: 8px;\n    width: 15px;\n    flex: 0 0 15px;\n    padding: 0px;\n}\ndiv.input-tag > ul.input-tag__tags > li button:focus {\n    outline: none;\n}\n\n\ndiv.input-tag > ul.input-tag__tags > li:not(.input-tag__tags__input) {\n    border: 1px solid #b3b3b3;\n}\n\ndiv.input-tag > ul.input-tag__tags > li.input-tag__tags__input {\n    background: none;\n    flex-grow: 1;\n    flex-basis: 50%;\n    min-width: 60px;\n    flex-shrink: 0;\n    padding: 0;\n}\n",""]);const i=r},463(n,e,t){t.d(e,{A:()=>i});var o=t(6314),r=t.n(o)()(function(n){return n[1]});r.push([n.id,'.jp-Notebook .metanno-table {\n    min-height: 100px;\n}\n\n.metanno-table {\n    height: 100%;\n    width: 100%;\n    overflow: hidden;\n    min-height: 50px;\n}\n\n.metanno-table, .metanno-table input {\n    font-family: var(--metanno-font-family);\n    font-size: var(--metanno-font-size);\n}\n\n.metanno-table-filter {\n    inline-size: 100%;\n    padding: 4px;\n    font-size: var(--metanno-font-size);\n    background: var(--background-color);\n    color: var(--color);\n    border: 1px solid var(--border-color);\n}\n\n.metanno-table-header-filter {\n    line-height: 30px;\n    padding: 0;\n}\n\n.metanno-table-header-filter > div > div {\n    padding-block: 0;\n    padding-inline: 4px;\n}\n\n.metanno-table-header-filter > div > div:first-child {\n    border-block-end: 1px solid var(--border-color);\n    padding-inline: 8px;\n}\n\n.metanno-table > div.rdg {\n    --font-size: var(--metanno-font-size); /* more specific than react-data-grid\'s .rnvodz5700-beta7 selector to override */\n    height: 100%;\n    border: none;\n}\n\n.metanno-table a {\n    color: #106ba3;\n}\n\n.metanno-table a:hover {\n    text-decoration: underline;\n}\n\n.metanno-table .rdg-cell-mask:focus {\n    outline: none;\n}\n\n.metanno-table .react-tagsinput {\n    background: transparent;\n    border: none;\n    padding-top: 0;\n    padding-bottom: 0;\n}\n\n.metanno-table .react-tagsinput > span {\n    line-height: 14px;\n}\n\n.metanno-table .react-tagsinput-tag, .metanno-table .react-tagsinput-input {\n    padding-top: 0;\n    padding-bottom: 0;\n    margin-top: 0;\n    margin-bottom: 0;\n}\n\n.metanno-table .react-tagsinput-tag {\n    background-color: #ffffff;\n    border-radius: 2px;\n    border: 1px solid #4a9bd2;\n    color: #000000;\n}\n\n.metanno-table .react-tagsinput-input:focus {\n    outline: none;\n}\n\n.metanno-table .react-tagsinput.disabled .react-tagsinput-input {\n    display: none;\n}\n\n\n.metanno-tagscell-container {\n\n}\n\n.rdg-row.metanno-row--highlighted {\n    background-color: var(--row-hover-background-color);\n}\n\n.metanno-table .rdg-row, .metanno-table .rdg-cell {\n    contain: initial;\n    overflow: visible;\n}\n\n.metanno-table .rdg-cell {\n    position: relative;\n}\n\n/* TAGS INPUT */\n.react-tagsinput {\n    background-color: #fff;\n    border: 1px solid #ccc;\n    overflow: hidden;\n    padding-left: 5px;\n    padding-top: 5px;\n}\n\n.react-tagsinput--focused {\n    border-color: #a5d24a;\n}\n\n.react-tagsinput-tag {\n    background-color: #cde69c;\n    border-radius: 2px;\n    border: 1px solid #a5d24a;\n    color: #638421;\n    display: inline-block;\n    font-family: sans-serif;\n    font-size: 13px;\n    font-weight: 400;\n    margin-bottom: 5px;\n    margin-right: 5px;\n    padding: 5px;\n}\n\n.react-tagsinput-remove {\n    cursor: pointer;\n    font-weight: bold;\n}\n\n.react-tagsinput-tag a::before {\n    content: " ×";\n}\n\n.react-tagsinput-input {\n    background: transparent;\n    border: 0;\n    color: #777;\n    font-family: sans-serif;\n    font-size: 13px;\n    font-weight: 400;\n    margin-bottom: 6px;\n    margin-top: 1px;\n    outline: none;\n    padding: 5px;\n    width: 80px;\n}\n\n.rdg-cell > button {\n    width: 100%;\n    cursor: pointer;\n    outline: none;\n    -webkit-appearance: none;\n    -moz-appearance: none;\n    color: black;\n    padding: 0;\n    background: #f8f8f8;\n    border: none;\n    box-shadow: var(--metanno-box-shadow);\n    border-radius: 2px 2px 2px 2px;\n}\n\n.rdg-cell-editing {\n    padding: 0\n}\n\n.rdg-cell:focus, .rdg-cell[aria-selected=true] {\n    outline: 0\n}\n\n.metanno-table .rdg-cell.rdg-cell-range-selected {\n    background-color: rgba(0, 120, 215, 0.18) !important;\n}\n\n.metanno-table > div {\n    overflow-y: scroll;\n    scrollbar-width: none; /* Firefox */\n    -ms-overflow-style: none;  /* Internet Explorer 10+ */\n}\n.metanno-table > div::-webkit-scrollbar { /* WebKit */\n    width: 0;\n    height: 0;\n}\n\n.rdg-cell a, .rdg-cell span {\n    max-width: 100%;\n    display: inline-block;\n    text-overflow: ellipsis;\n    overflow: hidden;\n}\n\n.rdg-cell:last-child {\n    border-right: none;\n}\n',""]);const i=r},1981(n,e,t){t.d(e,{A:()=>i});var o=t(6314),r=t.n(o)()(function(n){return n[1]});r.push([n.id,'/* Light Theme, feel free to override */\n:root[data-theme="light"] {\n    --metanno-color: #000;\n    --metanno-background-color: #fff;\n}\n\n/* Dark Theme, feel free to override */\n:root[data-theme="dark"] {\n    --metanno-color: #fff;\n    --metanno-background-color: #1f1d1d;\n}\n\n:root, .metanno-table > .rdg {\n    /* --metanno-font-size: 1rem; */\n    --metanno-font-family: Verdana, --apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";\n    --metanno-box-shadow: 0px 0px 2px 0px rgba(0, 0, 0, 0.24);\n}\n\n.jp-OutputArea {\n    --metanno-font-size: var(--jp-code-font-size);\n}\n',""]);const i=r},6314(n){n.exports=function(n){var e=[];return e.toString=function(){return this.map(function(e){var t=n(e);return e[2]?"@media ".concat(e[2]," {").concat(t,"}"):t}).join("")},e.i=function(n,t,o){"string"==typeof n&&(n=[[null,n,""]]);var r={};if(o)for(var i=0;i<this.length;i++){var l=this[i][0];null!=l&&(r[l]=!0)}for(var a=0;a<n.length;a++){var u=[].concat(n[a]);o&&r[u[0]]||(t&&(u[2]?u[2]="".concat(t," and ").concat(u[2]):u[2]=t),e.push(u))}},e}},5228(n){var e=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;n.exports=function(){try{if(!Object.assign)return!1;var n=new String("abc");if(n[5]="de","5"===Object.getOwnPropertyNames(n)[0])return!1;for(var e={},t=0;t<10;t++)e["_"+String.fromCharCode(t)]=t;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(n){return e[n]}).join(""))return!1;var o={};return"abcdefghijklmnopqrst".split("").forEach(function(n){o[n]=n}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},o)).join("")}catch(n){return!1}}()?Object.assign:function(n,r){for(var i,l,a=function(n){if(null==n)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(n)}(n),u=1;u<arguments.length;u++){for(var s in i=Object(arguments[u]))t.call(i,s)&&(a[s]=i[s]);if(e){l=e(i);for(var c=0;c<l.length;c++)o.call(i,l[c])&&(a[l[c]]=i[l[c]])}}return a}},1020(n,e,t){t(5228);var o=t(8893),r=60103;if("function"==typeof Symbol&&Symbol.for){var i=Symbol.for;r=i("react.element"),i("react.fragment")}var l=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a=Object.prototype.hasOwnProperty,u={key:!0,ref:!0,__self:!0,__source:!0};function s(n,e,t){var o,i={},s=null,c=null;for(o in void 0!==t&&(s=""+t),void 0!==e.key&&(s=""+e.key),void 0!==e.ref&&(c=e.ref),e)a.call(e,o)&&!u.hasOwnProperty(o)&&(i[o]=e[o]);if(n&&n.defaultProps)for(o in e=n.defaultProps)void 0===i[o]&&(i[o]=e[o]);return{$$typeof:r,type:n,key:s,ref:c,props:i,_owner:l.current}}e.jsx=s,e.jsxs=s},4848(n,e,t){n.exports=t(1020)},3052(n,e,t){var o=t(5072),r=t.n(o),i=t(1981);r()(i.A,{insert:"head",singleton:!1}),i.A.locals},5072(n,e,t){var o,r=function(){var n={};return function(e){if(void 0===n[e]){var t=document.querySelector(e);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(n){t=null}n[e]=t}return n[e]}}(),i=[];function l(n){for(var e=-1,t=0;t<i.length;t++)if(i[t].identifier===n){e=t;break}return e}function a(n,e){for(var t={},o=[],r=0;r<n.length;r++){var a=n[r],u=e.base?a[0]+e.base:a[0],s=t[u]||0,c="".concat(u," ").concat(s);t[u]=s+1;var d=l(c),p={css:a[1],media:a[2],sourceMap:a[3]};-1!==d?(i[d].references++,i[d].updater(p)):i.push({identifier:c,updater:g(p,e),references:1}),o.push(c)}return o}function u(n){var e=document.createElement("style"),o=n.attributes||{};if(void 0===o.nonce){var i=t.nc;i&&(o.nonce=i)}if(Object.keys(o).forEach(function(n){e.setAttribute(n,o[n])}),"function"==typeof n.insert)n.insert(e);else{var l=r(n.insert||"head");if(!l)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");l.appendChild(e)}return e}var s,c=(s=[],function(n,e){return s[n]=e,s.filter(Boolean).join("\n")});function d(n,e,t,o){var r=t?"":o.media?"@media ".concat(o.media," {").concat(o.css,"}"):o.css;if(n.styleSheet)n.styleSheet.cssText=c(e,r);else{var i=document.createTextNode(r),l=n.childNodes;l[e]&&n.removeChild(l[e]),l.length?n.insertBefore(i,l[e]):n.appendChild(i)}}function p(n,e,t){var o=t.css,r=t.media,i=t.sourceMap;if(r?n.setAttribute("media",r):n.removeAttribute("media"),i&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),n.styleSheet)n.styleSheet.cssText=o;else{for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(document.createTextNode(o))}}var f=null,h=0;function g(n,e){var t,o,r;if(e.singleton){var i=h++;t=f||(f=u(e)),o=d.bind(null,t,i,!1),r=d.bind(null,t,i,!0)}else t=u(e),o=p.bind(null,t,e),r=function(){!function(n){if(null===n.parentNode)return!1;n.parentNode.removeChild(n)}(t)};return o(n),function(e){if(e){if(e.css===n.css&&e.media===n.media&&e.sourceMap===n.sourceMap)return;o(n=e)}else r()}}n.exports=function(n,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=(void 0===o&&(o=Boolean(window&&document&&document.all&&!window.atob)),o));var t=a(n=n||[],e);return function(n){if(n=n||[],"[object Array]"===Object.prototype.toString.call(n)){for(var o=0;o<t.length;o++){var r=l(t[o]);i[r].references--}for(var u=a(n,e),s=0;s<t.length;s++){var c=l(t[s]);0===i[c].references&&(i[c].updater(),i.splice(c,1))}t=u}}}},7500(n,e,t){var o=t(4848),r=t(8893),i=t.n(r),l=function(){return l=Object.assign||function(n){for(var e,t=1,o=arguments.length;t<o;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n},l.apply(this,arguments)},a=function(n,e){var t="function"==typeof Symbol&&n[Symbol.iterator];if(!t)return n;var o,r,i=t.call(n),l=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)l.push(o.value)}catch(n){r={error:n}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(r)throw r.error}}return l},u=function(n,e,t){if(t||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return n.concat(o||Array.prototype.slice.call(e))},s=function(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],o=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&o>=n.length&&(n=void 0),{value:n&&n[o++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};function c(n,e,t,o,r,i,c,d,p,f){var h=function(n,e){for(var t=[],o=0;o<n.length;o++){var r=n[o].begin,i=n[o].end;t.push(r,i)}t.push(0,e.length),t=u([],a(new Set(t)),!1).sort(function(n,e){return n-e});for(var l,s,c,d=[],p=1;p<t.length;p++)l=t[p-1],s=t[p],c=e.slice(l,s),d.push({begin:t[p-1],end:t[p],label:null,token_annotations:[],text:c});return d}(n=(n=n.map(function(n,e){return{begin:n[o],end:n[r],mouseSelected:n.mouseSelected||!1,label:n[i]||null,style:n[c]||null,highlighted:n[d]||!1,selected:n[p]||!1,id:n[f]||e}})).sort(function(n,e){var t=n.begin,o=n.end,r=n.mouseSelected,i=e.begin,l=e.end;return r===e.mouseSelected?t!==i?t-i:l-o:r?-1:1}).map(function(n){return l(l({},n),{text:e.slice(n.begin,n.end)})}),e);!function(n,e,t,o){void 0===o&&(o=!0);var r=function(n){return!n},i=new Set,c=0,d=function(){var e=Math.max.apply(Math,u([],a(Array.from(i).map(function(e){return Math.max.apply(Math,u([],a(n[e].token_annotations.filter(function(n){return!n.mouseSelected}).map(function(n){return n.depth})),!1))||0})),!1))+1,r=Math.floor(e/2);i.forEach(function(e){n[e].token_annotations.forEach(function(n){var e;(o||"underline"===(null===(e=null==t?void 0:t[n.style])||void 0===e?void 0:e.shape))&&(n.depth=n.depth-r)})})};e.forEach(function(e,o){var a,u,p,f,h,g,v=e.begin,y=e.end,m=e.label,b=e.style,x=function(n,e){var t={};for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&e.indexOf(o)<0&&(t[o]=n[o]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(n);r<o.length;r++)e.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(n,o[r])&&(t[o[r]]=n[o[r]])}return t}(e,["begin","end","label","style"]);b=b||m;var w=null,k=null;x.mouseSelected||(v>=c?(d(),i.clear(),c=y):c<y&&(c=y));for(var S=0;S<n.length;S++)if(n[S].begin<y&&v<n[S].end){if(i.add(S),n[S].begin===v&&(n[S].label=m),null===w&&!x.mouseSelected&&!1!==(null===(p=t[b])||void 0===p?void 0:p.autoNestingLayout)){var C=[void 0],_=[void 0],j=[void 0];try{for(var O=(a=void 0,s(n[S].token_annotations)),R=O.next();!R.done;R=O.next()){var I=R.value,M=I.depth,A=I.zIndex,E=I.mouseSelected,T=I.style;E||(("underline"===(null===(f=t[T])||void 0===f?void 0:f.shape)?_:C)[M]=!0,j[A]=!0)}}catch(n){a={error:n}}finally{try{R&&!R.done&&(u=O.return)&&u.call(O)}finally{if(a)throw a.error}}-1===(w=("underline"===(null===(h=t[b])||void 0===h?void 0:h.shape)?_:C).findIndex(r))&&(w=("underline"===(null===(g=t[b])||void 0===g?void 0:g.shape)?_:C).length),-1===(k=j.findIndex(r))&&(k=j.length)}var P=l({depth:w,openleft:n[S].begin!==v,openright:n[S].end!==y,label:m,isFirstTokenOfSpan:n[S].begin===v,style:b,zIndex:k},x);n[S].token_annotations.unshift(P)}}),d()}(h,n,t);var g=n.map(function(n){return n.id}),v=function(n){for(var e=[],t=[],o=[],r=0;r<n.length;r++){var i=n[r],l=i.begin,a=i.token_annotations;o=i.text.length>0?i.text.match(/\n|-|[^ \n-]+|[ ]+/g).filter(function(n){return n.length>0}):[i.text];for(var u=0,s=0;s<o.length;s++){var c=l+u,d=l+u+o[s].length;"\n"===o[s]?(t.push(e),e=[]):e.push({text:o[s],key:"".concat(c,"-").concat(d),begin:c,end:d,tokenIndexInChunk:s,token_annotations:a,isFirstTokenOfChunk:0===s,isLastTokenOfChunk:s===o.length-1}),u+=o[s].length}}return(e.length>0||o.length&&"\n"===o[o.length-1])&&t.push(e),t}(h);return{lines:v,ids:g}}var d=t(5806),p=t.n(d),f=t(3824),h=t.n(f),g=function(n,e){var t="function"==typeof Symbol&&n[Symbol.iterator];if(!t)return n;var o,r,i=t.call(n),l=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)l.push(o.value)}catch(n){r={error:n}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(r)throw r.error}}return l},v=function(n,e,t){if(t||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return n.concat(o||Array.prototype.slice.call(e))},y=function(n,e){return n===e||"object"==typeof n&&"object"==typeof e&&null!==n&&null!==e&&Object.keys(n).length===Object.keys(e).length&&Object.keys(n).every(function(t){return e.hasOwnProperty(t)&&n[t]===e[t]})},m=function(n,e,t,o){void 0===e&&(e=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return n.length>0?n[0]:null}),void 0===t&&(t=!1),void 0===o&&(o=!1);var r=null,i=null;return function(){for(var l=[],a=0;a<arguments.length;a++)l[a]=arguments[a];if(o){var u=n.apply(void 0,v([],g(l),!1));return t&&y(u,i)||!t&&h()(u,i)||(i=u),i}var s=e.apply(void 0,v([],g(l),!1));return t&&y(r,s)&&null!==r||!t&&h()(r,s)&&null!==r||(r=s,i=n.apply(void 0,v([],g(l),!1))),i}};function b(n,e){if(n===e)return!0;var t,o,r=typeof n,i=typeof e;if(r!==i)return!1;if(!n||!e||"object"!==r&&"object"!==i)return n==e;if(Object.isFrozen(n))return!1;if(null===n||null===e)return!1;var l=Object.keys(n),a=Object.keys(e),u=l.length!==a.length;for(t=a.length-1;t>=0;t--)b(n[o=a[t]],e[o])?n[o]=e[o]:u=!0;return!u}var x=function(n){var e=[];return n.shiftKey&&e.push("Shift"),n.metaKey&&e.push("Meta"),n.ctrlKey&&e.push("Control"),e};function w(){var n=[],e=null,t=function(n){var e;return(null===(e=null==n?void 0:n.getAttribute)||void 0===e?void 0:e.call(n,"span_begin"))||n.parentElement.getAttribute("span_begin")||n.parentElement.parentElement.getAttribute("span_begin")};if(window.getSelection){for(var o=window.getSelection(),r=null,i=null,l=0;l<o.rangeCount;l++){e=o.getRangeAt(l);var a=parseInt(t(e.startContainer),10),u=parseInt(t(e.endContainer),10);isNaN(a)||(r=isNaN(r)||null===r?e.startOffset+a:Math.min(r,e.startOffset+a)),isNaN(u)||(i=isNaN(r)||null===r?e.endOffset+u:Math.max(i,e.endOffset+u))}return isNaN(r)||null===r||isNaN(i)||null===i||r===i||n.push({begin:r,end:i}),n}return document.selection&&document.selection.type,n}var k={current:null};function S(n){k.current=n}document.addEventListener("click",S,{capture:!0}),document.addEventListener("mousedown",S,{capture:!0}),document.addEventListener("mouseup",S,{capture:!0});var C=function(n,e){var t="function"==typeof Symbol&&n[Symbol.iterator];if(!t)return n;var o,r,i=t.call(n),l=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)l.push(o.value)}catch(n){r={error:n}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(r)throw r.error}}return l},_=function(n,e,t){if(t||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return n.concat(o||Array.prototype.slice.call(e))};function j(n){var e=(0,r.useRef)(n);return(0,r.useEffect)(function(){e.current=n}),(0,r.useCallback)(function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return e.current.apply(e,_([],C(n),!1))},[])}var O=t(5072),R=t.n(O),I=t(7494);R()(I.A,{insert:"head",singleton:!1}),I.A.locals;var M,A=(M=function(n,e){return M=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,e){n.__proto__=e}||function(n,e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t])},M(n,e)},function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=n}M(n,e),n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}),E=function(){return E=Object.assign||function(n){for(var e,t=1,o=arguments.length;t<o;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n},E.apply(this,arguments)},T=function(n,e){var t="function"==typeof Symbol&&n[Symbol.iterator];if(!t)return n;var o,r,i=t.call(n),l=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)l.push(o.value)}catch(n){r={error:n}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(r)throw r.error}}return l},P=function(n,e,t){if(t||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return n.concat(o||Array.prototype.slice.call(e))},N=function(){return"undefined"!=typeof window&&"undefined"!=typeof navigator&&/Mobi|Android|iPhone|iPad|iPod|Windows Phone|IEMobile|Opera Mini/i.test(navigator.userAgent||"")},V=i().memo(function(n){var e,t,r,i,l,a=n.text,u=n.begin,s=n.end,c=n.isFirstTokenOfChunk,d=n.isLastTokenOfChunk,p=(n.tokenIndexInChunk,n.token_annotations),f=n.refs,h=n.styles,g=n.mouseElements,v=p[0],y={box:0,underline:0},m={box:0,underline:0},b={};p.forEach(function(n){var e;n.mouseSelected||((n.highlighted>v.highlighted||n.highlighted===v.highlighted&&n.depth>v.depth)&&(v=n),n.isFirstTokenOfSpan&&n.label&&("underline"!==(null===(e=h[n.style])||void 0===e?void 0:e.shape)?m.box++:m.underline++),b[n.id]=n.zIndex)});for(var x=[],w=0,k=function(n){var r=p[n],i="underline"===(null===(e=null==h?void 0:h[r.style])||void 0===e?void 0:e.shape);r.mouseSelected?x.push((0,o.jsx)("span",{className:"mention_token mouse_selected"},"mouse-selection")):(w=3*r.depth-2,x.push((0,o.jsx)("span",{id:"span-".concat(u,"-").concat(s),span_key:r.id,ref:function(e){var t="".concat(r.id,"-span-").concat(n,"-").concat(u,"-").concat(s);e?g.current[t]=e:delete g.current[t],c&&f[r.id]&&(f[r.id].current=e)},className:"mention_token mention_".concat(i&&!r.highlighted?"underline":"box","\n                               ").concat(r.highlighted?"highlighted":"","\n                               ").concat(r.selected?"selected":"","\n                               ").concat(c&&!r.openleft?"closedleft":"","\n                               ").concat(d&&!r.openright?"closedright":""),style:E({top:i&&!r.highlighted?void 0:w,bottom:w,zIndex:r.zIndex+2+(r.selected?49:r.highlighted?50:0)},null===(t=null==h?void 0:h[r.style])||void 0===t?void 0:t[r.highlighted?"highlighted":"base"])},"annotation-".concat(n))))},S=0;S<p.length;S++)k(S);return(0,o.jsxs)("span",{className:"text-chunk",span_begin:u,children:[x,(0,o.jsx)("span",{className:"text-chunk-content",style:{color:null===(i=null===(r=null==h?void 0:h[null==v?void 0:v.style])||void 0===r?void 0:r[(null==v?void 0:v.highlighted)?"highlighted":"base"])||void 0===i?void 0:i.color},children:a}),c&&p.map(function(n,e){var t,r,i,a;if(n.isFirstTokenOfSpan&&n.label){l=(null===(r=h[n.style])||void 0===r?void 0:r.shape)||"box";var u=2.5*n.depth-2,s="underline"===l;return y[l]+=1,(0,o.jsx)("span",{className:"label ".concat(n.highlighted?"highlighted":""),ref:function(t){t?g.current["".concat(n.id,"-label-").concat(e)]=t:delete g.current["".concat(n.id,"-label-").concat(e)]},span_key:n.id,style:(t={borderColor:null===(a=null===(i=null==h?void 0:h[null==n?void 0:n.style])||void 0===i?void 0:i[(null==n?void 0:n.highlighted)?"highlighted":"base"])||void 0===a?void 0:a.borderColor},t[s?"bottom":"top"]=-9+u,t.left=6*(m[l]-y[l])+("box"===l?-1:2),t.zIndex=50+n.zIndex+(n.selected?49:n.highlighted?50:0),t),children:n.label.toUpperCase()},n.id)}})]})}),z=i().memo(function(n){var e=n.index,t=n.styles,i=n.tokens,l=n.spansRef,a=n.handleMouseEnterSpan,u=n.handleMouseLeaveSpan,s=n.handleMouseHoverSpans,c=n.handleClickSpan,d=n.divRef,p=(0,r.useRef)(new Set),f=(0,r.useRef)({}),h=function(n){var e=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return{clientX:e?e.clientX:n.clientX,clientY:e?e.clientY:n.clientY}},g=function(n){if(f&&p){var e=h(n),t=e.clientX,o=e.clientY,r=Object.values(f.current).map(function(n){if(n){var e=n.getBoundingClientRect();return t>=e.left&&t<=e.right&&o>=e.top&&o<=e.bottom?n:void 0}}).filter(function(n){return!!n}),i=new Set(r.map(function(n){return n.getAttribute("span_key")})),l=!1;p.current.forEach(function(e){i.has(e)||(l=!0,u(n,e))}),i.forEach(function(e){p.current.has(e)||(l=!0,a(n,e))}),l&&(p.current=i,s&&s(n,P([],T(i),!1)))}},v=function(n){p&&(p.current.forEach(function(e){return u(n,e)}),p.current.clear())},y=function(n){var e=h(n),t=e.clientX,o=e.clientY,r=Object.values(f.current).map(function(n){if(n){var e=n.getBoundingClientRect();return t>=e.left&&t<=e.right&&o>=e.top&&o<=e.bottom?n:void 0}}).filter(function(n){return!!n});r.length>1&&(r=r.filter(function(n){var e=n.getBoundingClientRect();return(n.className.includes("underline")||o>=e.top)&&o<=e.bottom}).sort(function(n,e){return Number.parseInt(e.style.zIndex)-Number.parseInt(n.style.zIndex)})),r.length>0?c(n,r[0].getAttribute("span_key")):c(n,null)};return(0,o.jsxs)("div",{ref:d,className:"line",onMouseMove:g,onMouseLeave:v,onMouseUp:y,onTouchStart:function(n){},onTouchMove:function(n){g(n)},onTouchEnd:function(n){y(n),v(n)},onTouchCancel:function(n){v(n)},style:{touchAction:"manipulation"},children:[(0,o.jsx)("span",{className:"line-number",children:e},"line-number"),i.map(function(n){return(0,o.jsx)(V,E({},n,{refs:l,styles:t,mouseElements:f}))})]})}),L=function(n){function e(e){var t,o,r=n.call(this,e)||this;if(r.isNodeInside=function(n){var e=r.containerRef.current;return!!e&&!!n&&(n===e||e.contains(n))},r.handleSelectionChange=function(){var n;if(!r._ignoreSelectionChange){var e="undefined"!=typeof window?null===(n=window.getSelection)||void 0===n?void 0:n.call(window):null;e&&!e.isCollapsed&&(r.isNodeInside(e.anchorNode)||r.isNodeInside(e.focusNode))&&setTimeout(function(){var n,e,t,o=w();if(o&&o.length>0){r._ignoreSelectionChange=!0,null===(e=(n=r.props).onMouseSelect)||void 0===e||e.call(n,o,x({}));try{null===(t=window.getSelection())||void 0===t||t.removeAllRanges()}catch(n){}setTimeout(function(){r._ignoreSelectionChange=!1},0)}},0)}},r.handleKeyUp=function(n){var e,t,o=n.key;"Spacebar"!==o&&" "!==o||(o=" ");var i=w();null===(t=(e=r.props).onKeyPress)||void 0===t||t.call(e,o,P(P([],T(r.props.mouseSelection),!1),T(i),!1),x(n))},r.handleKeyDown=function(n){"Spacebar"!==n.key&&" "!==n.key||n.preventDefault()},r.handleTouchUp=function(n){var e,t,o,i,l,a=w();r._ignoreSelectionChange=!0;try{null===(e=window.getSelection())||void 0===e||e.removeAllRanges()}catch(n){}a.length>0?null===(o=(t=r.props).onMouseSelect)||void 0===o||o.call(t,a,x(n)):null===(l=(i=r.props).onMouseSelect)||void 0===l||l.call(i,[],x(n)),setTimeout(function(){r._ignoreSelectionChange=!1},0)},r.handleMouseUp=function(n){var e,t,o,i;if("mouseup"===n.type){var l=w();window.getSelection().removeAllRanges(),l.length>0?null===(t=(e=r.props).onMouseSelect)||void 0===t||t.call(e,l,x(n)):null===(i=(o=r.props).onMouseSelect)||void 0===i||i.call(o,[],x(n))}},r.handleClickSpan=function(n,e){var t,o,i,l="undefined"!=typeof window?null===(t=window.getSelection)||void 0===t?void 0:t.call(window):null;l&&!l.isCollapsed||null===(i=(o=r.props).onClickSpan)||void 0===i||i.call(o,e,x(n))},r.handleMouseEnterSpan=function(n,e){var t,o;null===(o=(t=r.props).onMouseEnterSpan)||void 0===o||o.call(t,e,x(n))},r.handleMouseLeaveSpan=function(n,e){var t,o;null===(o=(t=r.props).onMouseLeaveSpan)||void 0===o||o.call(t,e,x(n))},r.handleMouseHoverSpans=function(n,e){var t,o;null===(o=(t=r.props).onMouseHoverSpans)||void 0===o||o.call(t,e,x(n))},r.linesRef=[],r.spansRef={},r.containerRef=i().createRef(),e.handle){var l=r.linesRef,a=r.spansRef;e.handle.current={scroll_to_line:function(n,e){var t;void 0===e&&(e="smooth"),n>=0&&n<l.length&&l[n]&&(null===(t=l[n].current)||void 0===t||t.scrollIntoView({behavior:e,block:"center"}))},scroll_to_span:function(n,e){void 0===e&&(e="smooth"),setTimeout(function(){var t,o;null===(o=null===(t=a[n])||void 0===t?void 0:t.current)||void 0===o||o.scrollIntoView({behavior:e,block:"center"})},10)},clear_current_mouse_selection:function(){window.getSelection().removeAllRanges()}}}return r.previousSelectedSpans="",r.tokenize=(t=c,o=null,function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var r=t.apply(void 0,function(n,e,t){if(t||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return n.concat(o||Array.prototype.slice.call(e))}([],function(n,e){var t="function"==typeof Symbol&&n[Symbol.iterator];if(!t)return n;var o,r,i=t.call(n),l=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)l.push(o.value)}catch(n){r={error:n}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(r)throw r.error}}return l}(n),!1)),i=b(r,o);return o=i?o:r}),r.processStyles=m(function(n){return Object.assign.apply(Object,P([{}],T(Object.keys(n).map(function(e){var t;return(t={})[e]=function(n){var e,t,o,r,i=n.color,l=n.shape,a=n.autoNestingLayout,u=n.labelPosition,s=function(n,e){var t={};for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&e.indexOf(o)<0&&(t[o]=n[o]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(n);r<o.length;r++)e.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(n,o[r])&&(t[o[r]]=n[o[r]])}return t}(n,["color","shape","autoNestingLayout","labelPosition"]);try{e=p()(i).alpha(.8)}catch(n){e=p()("lightgray")}return e.isLight()?(r="#000000de",o=e.lighten(.02).toString(),t=e.darken(.05).toString()):(r="#ffffffde",o=e.darken(.02).toString(),t=e.lighten(.05).toString()),{base:E({borderColor:i,backgroundColor:"underline"===l?"transparent":o,color:"underline"===l?void 0:r},s),highlighted:E({borderColor:t,backgroundColor:o,color:r},s),autoNestingLayout:a,labelPosition:u,shape:l}}(n[e]),t})),!1))}),r._ignoreSelectionChange=!1,r._boundSelectionChange=r.handleSelectionChange.bind(r),r}return A(e,n),e.prototype.componentDidMount=function(){N()&&document.addEventListener("selectionchange",this._boundSelectionChange)},e.prototype.componentWillUnmount=function(){this.props.handle&&(this.props.handle.current=null),N()&&document.removeEventListener("selectionchange",this._boundSelectionChange)},e.prototype.render=function(){var n=this,e=this.processStyles(this.props.annotationStyles),t=this.props.text||"",r=JSON.stringify(this.props.spans.filter(function(n){return n.selected}).map(function(n){return n.id}));r!=this.previousSelectedSpans&&(document.documentElement.style.setProperty("--blink-animation",""),setTimeout(function(){document.documentElement.style.setProperty("--blink-animation","blink .5s step-end infinite alternate")},1),this.previousSelectedSpans=r);for(var l,a,u=this.tokenize(P(P([],T(this.props.mouseSelection.map(function(n){return E(E({},n),{mouseSelected:!0})})),!1),T(this.props.spans),!1),t,e,this.props.beginKey,this.props.endKey,this.props.labelKey,this.props.styleKey,this.props.highlightedKey,this.props.selectedKey,this.props.primaryKey),s=u.lines,c=u.ids,d=this.linesRef.length;d<s.length;d++)this.linesRef.push(i().createRef());return this.linesRef=this.linesRef.slice(0,s.length),l=this.spansRef,a=Object.fromEntries(c.map(function(e){return[e,n.spansRef[e]||i().createRef()]})),Object.keys(l).forEach(function(n){delete l[n]}),Object.assign(l,a),(0,o.jsx)("div",{className:"metanno-text-view",ref:this.containerRef,onMouseUp:this.handleMouseUp,onTouchEnd:function(e){var t;null===(t=e.persist)||void 0===t||t.call(e),setTimeout(function(){return n.handleTouchUp(e)},0)},onTouchCancel:function(e){var t,o;return null===(o=(t=n.props).onMouseSelect)||void 0===o?void 0:o.call(t,[],x(e))},onKeyDown:this.handleKeyDown,onKeyUp:this.handleKeyUp,tabIndex:0,style:this.props.style,children:(0,o.jsx)("div",{className:"text",children:s.map(function(t,r){return(0,o.jsx)(z,{divRef:n.linesRef[r],spansRef:n.spansRef,index:r,tokens:t,styles:e,handleMouseEnterSpan:n.handleMouseEnterSpan,handleMouseLeaveSpan:n.handleMouseLeaveSpan,handleMouseHoverSpans:n.handleMouseHoverSpans,handleClickSpan:n.handleClickSpan},r)})})})},e.defaultProps={spans:[],mouseSelection:[],text:"",annotationStyles:{},beginKey:"begin",endKey:"end",labelKey:"label",styleKey:"style",highlightedKey:"highlighted",selectedKey:"selected",primaryKey:"id"},e}(i().Component),K=t(5082),D=t(1330),F=t(5200),B=t(463);R()(B.A,{insert:"head",singleton:!1}),B.A.locals;var U=function(n,e){var t="function"==typeof Symbol&&n[Symbol.iterator];if(!t)return n;var o,r,i=t.call(n),l=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)l.push(o.value)}catch(n){r={error:n}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(r)throw r.error}}return l};function H(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return(0,r.useCallback)(function(e){var t,o;try{for(var r=function(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],o=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&o>=n.length&&(n=void 0),{value:n&&n[o++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),i=r.next();!i.done;i=r.next()){var l=i.value;"function"==typeof l?l(e):null!==l&&"current"in l&&(l.current=e)}}catch(n){t={error:n}}finally{try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(t)throw t.error}}},n)}const q=function(n){var e=n.isCellSelected,t=n.column,i=n.children,l=n.onColumnsReorder,a=function(n){var e=(0,r.useRef)(null);return(0,r.useLayoutEffect)(function(){var t;n&&(null===(t=e.current)||void 0===t||t.focus({preventScroll:!0}))},[n]),{ref:e,tabIndex:n?0:-1}}(e),u=a.ref,s=a.tabIndex,c=U((0,K.useDrag)({type:"METANNO_COLUMN_DRAG",item:{key:t.key},collect:function(n){return{isDragging:!!n.isDragging()}}}),2),d=c[0].isDragging,p=c[1],f=U((0,K.useDrop)({accept:"METANNO_COLUMN_DRAG",drop:function(n){var e=n.key;l(e,t.key)},collect:function(n){return{isOver:!!n.isOver(),canDrop:!!n.canDrop()}}}),2),h=f[0].isOver,g=f[1];return(0,o.jsxs)("div",{ref:H(p,g),style:{opacity:d?.5:1,backgroundColor:h?"#ececec":"transparent",cursor:"move"},children:[(0,o.jsx)("div",{children:t.name}),i?(0,o.jsxs)("div",{children:[" ",i({ref:u,tabIndex:s})," "]}):null]})};var W=t(2644),X=t.n(W),Y=t(3105);R()(Y.A,{insert:"head",singleton:!1}),Y.A.locals;var G=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,e){n.__proto__=e}||function(n,e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t])},n(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),J=function(){return J=Object.assign||function(n){for(var e,t=1,o=arguments.length;t<o;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n},J.apply(this,arguments)},$=function(n,e){var t={};for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&e.indexOf(o)<0&&(t[o]=n[o]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(n);r<o.length;r++)e.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(n,o[r])&&(t[o[r]]=n[o[r]])}return t},Z=function(n,e){var t="function"==typeof Symbol&&n[Symbol.iterator];if(!t)return n;var o,r,i=t.call(n),l=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)l.push(o.value)}catch(n){r={error:n}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(r)throw r.error}}return l},Q=function(n,e,t){if(t||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return n.concat(o||Array.prototype.slice.call(e))},nn=[];function en(n){return"string"==typeof n?n:n&&n.text?n.text:""}var tn=function(n){var e=n.value,t=n.inputProps,r=void 0===t?{}:t,i=n.autocontain,l=void 0!==i&&i,a=n.readOnly,u=void 0!==a&&a,s=n.hyperlink,c=void 0!==s&&s,d=n.onRemoveTag,p=void 0===d?null:d,f=n.onClick,h=void 0===f?null:f,g=(0,o.jsx)("div",{className:"input-tag ".concat(u?"":"editable"),children:(0,o.jsxs)("ul",{className:"input-tag__tags",children:[e.map(function(n,e){return(0,o.jsxs)("li",{children:[c?(0,o.jsx)("a",{onClick:function(){return h(n.key)},children:n.text}):(0,o.jsx)("span",{children:n}),u?null:(0,o.jsx)("button",{type:"button",onClick:function(){return!!p&&p(e)},children:"✕"})]},e)}),u?null:(0,o.jsx)("li",{className:"input-tag__tags__input",children:(0,o.jsx)("input",J({autoFocus:!0,type:"text"},r))})]})});return l?(0,o.jsx)("div",{className:"input-tag-container",children:g}):g},on=function(n){function e(e){var t=n.call(this,e)||this;return t.onInputChange=function(n,e){var o,r,i,l=e.newValue,a=e.method;"click"===a?(t.props.onRowChange(((o={})[t.props.column]=l,o),t.props.row_id,!0),t.props.onClose()):(t.setState(function(n){return{inputValue:l}}),null===(i=(r=t.props).onInputChange)||void 0===i||i.call(r,l,a),"type"===a&&(t.lastTypedValue=en(l)))},t.inputKeyDown=function(n){var e,o=!1;if("Tab"===n.key||"Enter"===n.key){var r=void 0===t.props.inputValue?t.state.inputValue:t.props.inputValue;t.props.hyperlink&&"object"!=typeof r||t.props.onRowChange(((e={})[t.props.column]=r,e),t.props.row_id,!0)}else["ArrowUp","ArrowDown"].includes(n.key)&&t.props.suggestions?o=!0:["Escape"].includes(n.key)&&t.props.onClose();o&&(n.preventDefault(),n.stopPropagation())},t.onAutoSuggestRef=function(n){t.autoSuggestRef=n,t.props.inputRef&&(t.props.inputRef.current=n?n.input:null,n&&(n.input.focus(),n&&n.input&&"function"==typeof n.input.select&&n.input.select())),t.updateHighlightedSuggestion()},t.updateHighlightedSuggestion=function(){if(t.autoSuggestRef){var n=en(t.props.value),e=t.getFilteredSuggestions(),o=e.flatMap(function(e,t){return n==en(e)?[t]:nn})[0];void 0!==o&&t.autoSuggestRef.setState({highlightedSectionIndex:null,highlightedSuggestionIndex:o,highlightedSuggestion:e[o]})}},t.renderSuggestion=function(n){return(0,o.jsx)("div",{children:t.props.hyperlink?(0,o.jsx)("a",{onClick:function(){var e,o;return null===(o=(e=t.props).onClick)||void 0===o?void 0:o.call(e,n.key)},children:n.text}):n})},t.renderInput=function(n){var e=n.hyperlink,t=$(n,["hyperlink"]);return e?(0,o.jsx)("a",{children:(0,o.jsx)("input",J({},t))}):(0,o.jsx)("input",J({},t))},t.onSuggestionsFetchRequested=function(){},t.onSuggestionsClearRequested=function(){},t.state={inputValue:e.value},t.lastTypedValue=null,t.autoSuggestRef=null,t}return G(e,n),e.prototype.componentDidMount=function(){var n=this;this.setState({inputValue:this.props.value}),this.props.onInputChange(this.props.value,"mount"),setTimeout(function(){var e,t=null===(e=n.autoSuggestRef)||void 0===e?void 0:e.suggestionsContainer;t&&"function"==typeof t.scrollIntoView&&t.scrollIntoView({block:"nearest"})},0)},e.prototype.componentWillUnmount=function(){this.setState({inputValue:null}),this.props.onInputChange(null,"unmount")},e.prototype.getFilteredSuggestions=function(){var n=this,e=this.props.suggestions instanceof Function?this.props.suggestions(this.lastTypedValue):this.props.suggestions||[];if(!this.lastTypedValue)return e;var t=e.filter(function(e){return en(e).toLowerCase().includes(n.lastTypedValue.toLowerCase())});return 0===t.length?e:t},e.prototype.render=function(){var n={placeholder:"Type here",value:en(void 0===this.props.inputValue?this.state.inputValue:this.props.inputValue),onChange:this.onInputChange,onKeyDown:this.inputKeyDown,hyperlink:this.props.hyperlink},e=this.getFilteredSuggestions();return(0,o.jsx)("div",{onKeyDown:function(n){return n.defaultPrevented&&n.stopPropagation()},children:(0,o.jsx)(X(),{ref:this.onAutoSuggestRef,alwaysRenderSuggestions:!0,onSuggestionsFetchRequested:this.onSuggestionsFetchRequested,onSuggestionsClearRequested:this.onSuggestionsClearRequested,suggestions:e,renderInputComponent:this.renderInput,getSuggestionValue:function(n){return n},renderSuggestion:this.renderSuggestion,inputProps:n})})},e.defaultProps={hyperlink:!1,suggestions:[]},e}(i().Component),rn=function(n){function e(e){var t=n.call(this,e)||this;return t.onInputChange=function(n,e){var o,r,i=e.newValue,l=e.method,a=Q([],Z(t.getInputValue()||[]),!1);a[a.length-1]=i,t.setState(function(n){return{inputValue:a}}),null===(r=(o=t.props).onInputChange)||void 0===r||r.call(o,a,l),"type"===l&&(t.lastTypedValue=en(i))},t.removeTag=function(n){var e,o,r=void 0===t.props.inputValue?t.state.inputValue:t.props.inputValue,i=Q([],Z(r||[]),!1);i.splice(n,1),t.setState({inputValue:i}),null===(o=(e=t.props).onInputChange)||void 0===o||o.call(e,i,"remove")},t.addTag=function(){var n=void 0===t.props.inputValue?t.state.inputValue:t.props.inputValue,e=Q([],Z(n||[]),!1);e.push(""),t.setState({inputValue:e}),t.props.onInputChange(e,"add")},t.inputKeyDown=function(n){var e,o,r=!1,i=n.target.value,l=t.getInputValue();"Tab"!==n.key&&"Enter"!==n.key||!i?"Backspace"!==n.key||i?t.props.suggestions&&["ArrowUp","ArrowDown"].includes(n.key)?r=!1:["Enter","Tab","ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(n.key)?r=!0:["Escape"].includes(n.key)&&t.props.onClose():t.removeTag(l.length-1):(t.addTag(),t.needsInputScroll=!0,n.preventDefault(),n.stopPropagation()),r&&(""===t.getEditedValue()?t.props.onRowChange(((e={})[t.props.column]=l.slice(0,l.length-1),e),t.props.row_id,!0):t.props.onRowChange(((o={})[t.props.column]=l,o),t.props.row_id,!0))},t.onAutoSuggestRef=function(n){t.autoSuggestRef=n,t.props.inputRef&&(t.props.inputRef.current=n?n.input:null,n&&(n.input.focus(),n&&n.input&&"function"==typeof n.input.select&&n.input.select()))},t.renderSuggestion=function(n){return(0,o.jsx)("div",{children:t.props.hyperlink?(0,o.jsx)("a",{onClick:function(){var e,o;return null===(o=(e=t.props).onClick)||void 0===o?void 0:o.call(e,t.props.row_id,t.props.column,n.key)},children:n.text}):n})},t.renderInput=function(n){var e=n.hyperlink,r=$(n,["hyperlink"]),i=t.getInputValue();return(0,o.jsx)(tn,{value:i.slice(0,i.length-1),inputProps:r,onRemoveTag:t.removeTag,hyperlink:!!e})},t.onSuggestionsFetchRequested=function(){},t.onSuggestionsClearRequested=function(){},t.state={inputValue:e.value},t.needsInputScroll=!1,t.lastTypedValue=null,t}return G(e,n),e.prototype.getInputValue=function(){var n=void 0===this.props.inputValue?this.state.inputValue:this.props.inputValue;return Array.isArray(n)?n:[]},e.prototype.getEditedValue=function(){var n=void 0===this.props.inputValue?this.state.inputValue:this.props.inputValue;return Array.isArray(n)?n[n.length-1]:null},e.prototype.componentDidMount=function(){var n=this;this.setState({inputValue:Q(Q([],Z(this.props.value),!1),[""],!1)}),this.props.onInputChange(Q(Q([],Z(this.props.value),!1),[""],!1),"mount"),setTimeout(function(){var e,t=null===(e=n.autoSuggestRef)||void 0===e?void 0:e.suggestionsContainer;t&&"function"==typeof t.scrollIntoView&&t.scrollIntoView({block:"nearest"})},0)},e.prototype.componentWillUnmount=function(){this.setState({inputValue:null}),this.props.onInputChange(null,"unmount")},e.prototype.getFilteredSuggestions=function(){var n=this,e=Array.isArray(this.props.suggestions)?this.props.suggestions:this.props.suggestions(this.lastTypedValue);if(!this.lastTypedValue)return e;var t=e.filter(function(e){return en(e).toLowerCase().includes(n.lastTypedValue.toLowerCase())});return 0===t.length?e:t},e.prototype.render=function(){var n={placeholder:"Type here",value:en(this.getEditedValue()),onChange:this.onInputChange,onKeyDown:this.inputKeyDown,hyperlink:this.props.hyperlink},e=this.getFilteredSuggestions();return(0,o.jsx)("div",{onKeyDown:function(n){return n.defaultPrevented&&n.stopPropagation()},children:(0,o.jsx)(X(),{ref:this.onAutoSuggestRef,alwaysRenderSuggestions:!0,suggestions:e,onSuggestionsFetchRequested:this.onSuggestionsFetchRequested,onSuggestionsClearRequested:this.onSuggestionsClearRequested,renderInputComponent:this.renderInput,getSuggestionValue:function(n){return n},renderSuggestion:this.renderSuggestion,inputProps:n})})},e.prototype.componentDidUpdate=function(){this.needsInputScroll&&this.props.inputRef&&this.props.inputRef.current&&this.props.inputRef.current.scrollIntoView({behavior:"smooth"}),this.needsInputScroll=!1},e.defaultProps={hyperlink:!1,suggestions:[]},e}(i().Component),ln=t(2375);R()(ln.A,{insert:"head",singleton:!1}),ln.A.locals;var an="rdg-checkbox-label ".concat("c1w6d5eo700-beta7"),un="rdg-checkbox-input ".concat("c1h7iz8d700-beta7"),sn="rdg-checkbox ".concat("cc79ydj700-beta7"),cn="rdg-checkbox-label-disabled ".concat("c1e5jt0b700-beta7"),dn="undefined"==typeof window?r.useEffect:r.useLayoutEffect;function pn(n){var e=n.value,t=n.isCellSelected,i=n.disabled,l=(n.onClick,n.onChange),a=n["aria-label"],u=n["aria-labelledby"],s=function(n){var e=(0,r.useRef)(null);return dn(function(){var t;n&&(null==(t=e.current)||t.focus({preventScroll:!0}))},[n]),{ref:e,tabIndex:n?0:-1}}(t),c=s.ref,d=s.tabIndex;return(0,o.jsx)("div",{className:"rdg-checkbox-container",children:(0,o.jsxs)("label",{className:"".concat(an," ").concat(i?cn:""),children:[(0,o.jsx)("input",{"aria-label":a,"aria-labelledby":u,ref:c,type:"checkbox",tabIndex:d,className:un,disabled:i,checked:e,onChange:function(n){l(n.target.checked,n.nativeEvent.shiftKey)}}),(0,o.jsx)("div",{className:sn})]})})}var fn=function(){return fn=Object.assign||function(n){for(var e,t=1,o=arguments.length;t<o;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n},fn.apply(this,arguments)},hn=function(n,e){var t="function"==typeof Symbol&&n[Symbol.iterator];if(!t)return n;var o,r,i=t.call(n),l=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)l.push(o.value)}catch(n){r={error:n}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(r)throw r.error}}return l},gn=function(n,e,t){if(t||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return n.concat(o||Array.prototype.slice.call(e))};function vn(n){var e=n.target,t=e.selectionStart;"ArrowLeft"===n.key&&t>0&&n.stopPropagation(),"ArrowRight"===n.key&&t<e.value.length&&n.stopPropagation()}var yn=i().createContext(void 0);yn.displayName="SuggestionsContext",K.DndContext.displayName="DndContext";var mn=i().createContext(null);mn.displayName="TableFiltersContext";var bn=(0,r.memo)(function(n){var e,t=n.columnKey,r=n.inputProps,l=i().useContext(mn),a=null===(e=null==l?void 0:l.filters)||void 0===e?void 0:e[t];return(0,o.jsx)("input",fn({},r,{className:"metanno-table-filter",value:a||"",onChange:function(n){return null==l?void 0:l.onFilterChange(t,n.target.value)},onKeyDown:vn}))}),xn=t(4423),wn=t(5705),kn=t.n(wn),Sn=function(){return Sn=Object.assign||function(n){for(var e,t=1,o=arguments.length;t<o;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n},Sn.apply(this,arguments)},Cn=function(n,e){var t="function"==typeof Symbol&&n[Symbol.iterator];if(!t)return n;var o,r,i=t.call(n),l=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)l.push(o.value)}catch(n){r={error:n}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(r)throw r.error}}return l},_n=function(n,e,t){if(t||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return n.concat(o||Array.prototype.slice.call(e))},jn=function(n){var e=Cn(kn()(n.image),1)[0],t=(0,r.useRef)(null),i=(0,r.useRef)(null),l=(0,r.useRef)(null),a=Cn((0,r.useState)({width:800,height:600}),2),u=a[0],s=a[1];(0,r.useEffect)(function(){if(l.current){var n=new ResizeObserver(function(n){var e,t;try{for(var o=function(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],o=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&o>=n.length&&(n=void 0),{value:n&&n[o++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),r=o.next();!r.done;r=o.next()){var i=r.value;s({width:i.contentRect.width,height:i.contentRect.height})}}catch(n){e={error:n}}finally{try{r&&!r.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}});return n.observe(l.current),function(){return n.disconnect()}}},[]),(0,r.useImperativeHandle)(n.handle,function(){return{}},[]);var c=1,d=0,p=0;e&&(c=Math.min(u.width/e.width,u.height/e.height),d=(u.width-e.width*c)/2,p=(u.height-e.height*c)/2);var f=function(n){var e=[];return n.shiftKey&&e.push("Shift"),n.ctrlKey&&e.push("Ctrl"),n.altKey&&e.push("Alt"),n.metaKey&&e.push("Meta"),e},h=Cn((0,r.useState)(!1),2),g=h[0],v=h[1],y=Cn((0,r.useState)({x:0,y:0,width:0,height:0}),2),m=y[0],b=y[1],x=(0,r.useRef)(null),w=function(e,t){var o;e.cancelBubble||(null===(o=e.evt)||void 0===o?void 0:o.cancelBubble)||n.onClick&&(n.onClick(void 0===t?null:t,f(e)),e.evt.cancelBubble=!0,e.cancelBubble=!0)},k=function(e,t){var o;e.cancelBubble||(null===(o=e.evt)||void 0===o?void 0:o.cancelBubble)||n.onMouseEnterShape&&n.onMouseEnterShape(t,f(e))},S=function(e,t){var o;e.cancelBubble||(null===(o=e.evt)||void 0===o?void 0:o.cancelBubble)||n.onMouseLeaveShape&&n.onMouseLeaveShape(t,f(e))};return(0,o.jsx)("div",{tabIndex:0,onKeyDown:function(e){n.onKeyPress&&n.onKeyPress(e.key,f(e))},style:Sn({width:"100%",height:"100%",overflow:"hidden",outline:"none"},n.style),ref:l,children:(0,o.jsx)(xn.Stage,{width:u.width,height:u.height,children:(0,o.jsx)(xn.Layer,{x:d,y:p,scaleX:c,scaleY:c,onClick:w,children:(0,o.jsxs)(xn.Group,{ref:t,onMouseDown:function(n){var e;if(!n.cancelBubble&&!(null===(e=n.evt)||void 0===e?void 0:e.cancelBubble)&&t.current){var o=t.current.getRelativePointerPosition();x.current=o,v(!0),b({x:o.x,y:o.y,width:0,height:0})}},onMouseMove:function(n){var e;if(!n.cancelBubble&&!(null===(e=n.evt)||void 0===e?void 0:e.cancelBubble)&&g&&t.current){var o=t.current.getRelativePointerPosition(),r=x.current;r&&b({x:Math.min(r.x,o.x),y:Math.min(r.y,o.y),width:Math.abs(o.x-r.x),height:Math.abs(o.y-r.y)})}},onMouseUp:function(e){var t;if(!e.cancelBubble&&!(null===(t=e.evt)||void 0===t?void 0:t.cancelBubble)&&g){if(v(!1),n.onMouseSelect&&m.width>0&&m.height>0){var o=f(e.evt),r={type:"rect",points:[m.x,m.y,m.width,m.height]};n.onMouseSelect(o,[r]),e.evt.cancelBubble=!0,e.cancelBubble=!0}b({x:0,y:0,width:0,height:0})}},children:[e&&(0,o.jsx)(xn.Image,{image:e,ref:i}),n.annotations.map(function(e,t){return function(e,t){var r,i=Sn({strokeColor:"red",strokeWidth:2,fillColor:"transparent",opacity:1,shape:"rect",align:"center",verticalAlign:"middle",fontSize:14},("string"!=typeof e.style?e.style:n.annotationStyles[e.style])||{}),l=null;if("polygon"===i.shape){l=(0,o.jsx)(xn.Line,{points:e.points,closed:!0,stroke:i.strokeColor,strokeWidth:i.strokeWidth,fill:i.fillColor,opacity:i.opacity,onClick:function(n){return w(n,t)},onMouseEnter:function(n){return k(n,t)},onMouseLeave:function(n){return S(n,t)}});var a=e.points,u=a.filter(function(n,e){return e%2==0}),s=a.filter(function(n,e){return e%2==1});r={x:Math.min.apply(Math,_n([],Cn(u),!1)),y:Math.min.apply(Math,_n([],Cn(s),!1)),width:Math.max.apply(Math,_n([],Cn(u),!1))-Math.min.apply(Math,_n([],Cn(u),!1)),height:Math.max.apply(Math,_n([],Cn(s),!1))-Math.min.apply(Math,_n([],Cn(s),!1))}}else l=(0,o.jsx)(xn.Rect,{x:e.points[0],y:e.points[1],width:e.points[2],height:e.points[3],stroke:i.strokeColor,strokeWidth:i.strokeWidth,fill:i.fillColor,opacity:i.opacity,onClick:function(n){return w(n,t)},onMouseEnter:function(n){return k(n,t)},onMouseLeave:function(n){return S(n,t)}}),r={x:e.points[0],y:e.points[1],width:e.points[2],height:e.points[3]};var c=null;return e.label&&(c=(0,o.jsx)(xn.Text,{text:e.label,fontSize:14,x:r.x+5,y:r.y+5,width:r.width-10,height:r.height-10,fill:i.textColor||"black",align:i.align,verticalAlign:i.verticalAlign,listening:!1})),(0,o.jsxs)(xn.Group,{children:[l,c]},"annotation-".concat(t))}(e,t)}),n.mouseSelection.map(function(n,e){return function(n,e){return"rect"===n.type?(0,o.jsx)(xn.Rect,{x:n.points[0],y:n.points[1],width:n.points[2],height:n.points[3],fill:"#89BCFA99",stroke:"#89BCFA",strokeWidth:1},"selection-".concat(e)):"polygon"===n.type?(0,o.jsx)(xn.Line,{points:n.points,closed:!0,stroke:"blue",strokeWidth:1,dash:[4,4]},"selection-".concat(e)):null}(n,e)}),g&&(0,o.jsx)(xn.Rect,{x:m.x,y:m.y,width:m.width,height:m.height,fill:"#89BCFA99",stroke:"#89BCFA",strokeWidth:1})]})})})})};jn.defaultProps={annotations:[],mouseSelection:[],annotationStyles:{}},window.Metanno={AnnotatedText:L,Table:function(n){var e,t=n.primaryKey,l=n.rows,a=n.selection,u=n.multiSelectionMode,s=n.filters,c=n.columns,d=n.autoFilter,p=n.subset,f=n.onSubsetChange,h=n.handle,g=n.onInputChange,v=n.inputValue,y=n.onMouseEnterRow,w=n.onMouseLeaveRow,S=n.onMouseHoverRow,O=n.highlightedRows,R=n.style,I=n.onFiltersChange,M=n.onSelectionChange,A=n.onCellChange,E=n.onScrollBottom,T=n.onClickCellContent,P=n.suggestions,N=hn((0,r.useState)(c.map(function(n){return n.key})),2),V=N[0],z=N[1],L=hn((0,r.useState)(void 0),2),B=L[0],U=L[1],H=hn((0,r.useState)(!1),2),W=H[0],X=H[1],Y=hn((0,r.useState)({}),2),G=Y[0],J=Y[1],$=(0,r.useRef)(null),Z=void 0===s?G:s,Q=a,nn=j(function(n){return void 0!==cn?cn[n]:n}),en=(0,r.useRef)(null),ln=(0,r.useRef)(null),an=(0,r.useRef)(0),un=(0,r.useRef)(l);(0,r.useEffect)(function(){un.current=l},[l]);var sn=(0,r.useMemo)(function(){if(d&&Z&&(void 0===p||f)){var n=m(function(n){return Object.fromEntries(Object.entries(n).filter(function(n){var e=hn(n,2);return e[0],""!==e[1]}).map(function(n){var e=hn(n,2);return[e[0],e[1].toLowerCase()]}))})(Z),e=l.map(function(n,e){return{row:n,idx:e}}).filter(function(e){var t=e.row;return Object.entries(n).every(function(n){var e=hn(n,2),o=e[0],r=e[1];return void 0===t[o]||null!==t[o]&&t[o].toString().toLowerCase().includes(r)})}).map(function(n){return n.idx});return null==f||f(e),e}},[Z,l,d,s]),cn=void 0!==p?p:sn,dn=j(function(n,e){var t,o=fn(fn({},Z),((t={})[n]=e,t));null==I||I(o,n),void 0===s&&J(function(t){var o;return fn(fn({},t),((o={})[n]=e,o))})}),vn=(0,r.useMemo)(function(){return{filters:Z,onFilterChange:dn}},[Z,dn]);(0,r.useImperativeHandle)(h,function(){return{scroll_to_row_idx:function(n){var e,t=cn?cn.indexOf(n):n;-1!==t&&(null===(e=en.current)||void 0===e||e.scrollToRow(t))},scroll_to_row_id:function(n){var e;if(t){var o=un.current.findIndex(function(e){return e[t]===n}),r=cn?cn.indexOf(o):o;-1!==r&&(null===(e=en.current)||void 0===e||e.scrollToRow(r))}},focus:function(){var n,e,t=(null===(n=ln.current)||void 0===n?void 0:n.input)||ln.current;k.current.preventDefault(),t?t.focus():null===(e=en.current)||void 0===e||e.element.focus()}}},[h,t,cn]);var xn,wn,kn,Sn=(0,r.useMemo)(function(){return void 0!==cn?cn.map(function(n){return l[n]}):l},[l,cn]),Cn=function(n,e){return function(o,r){var i=nn(n);null==g||g(t&&null!==i?un.current[i][t]:null,i,e.key,o,r)}},_n=function(n,e){var t=V.indexOf(n),o=V.indexOf(e),r=gn([],hn(V),!1);r.splice(o,0,r.splice(t,1)[0]),z(r)},jn=function(n){return n.filterable?function(e){return(0,o.jsx)(bn,{inputProps:e,columnKey:n.key})}:null},On=(0,r.useMemo)(function(){var n=c.map(function(n){var e,l=function(n,e,l){switch(n){case"hyperlink":return{editor:e?null:(0,r.forwardRef)(function(n,e){var t=n.row,r=n.column,l=n.onRowChange,a=n.onClose,u=n.rowIdx,s=i().useContext(yn);return(0,o.jsx)(on,{ref:e,row_id:nn(u),inputRef:ln,value:t[r.key],column:r.key,inputValue:v,onInputChange:Cn(u,r),suggestions:void 0===s?c[r.idx].choices:s,onRowChange:l,onClose:a,hyperlink:!0})}),headerCellClass:l?"metanno-table-header-filter":void 0,headerRenderer:function(n){return(0,o.jsx)(q,fn({},n,{onColumnsReorder:_n,children:jn(n.column)}))},formatter:function(n){var e=n.row,r=n.rowIdx,i=n.column,l=e[i.key],a=(null==l?void 0:l.text)||l,u=(null==l?void 0:l.key)||l;return l?(0,o.jsx)("a",{onClick:function(n){(null==T?void 0:T(t?e[t]:null,r,i.key,u))&&(n.preventDefault(),n.stopPropagation())},children:a}):null}};case"multi-hyperlink":return{editor:e?null:(0,r.forwardRef)(function(n,e){var t=n.row,r=n.rowIdx,l=n.column,a=n.onRowChange,u=n.onClose,s=i().useContext(yn);return(0,o.jsx)(rn,{ref:e,row_id:nn(r),inputRef:ln,value:t[l.key],inputValue:v,column:l.key,suggestions:void 0===s?c[l.idx].choices:s,onRowChange:a,onInputChange:Cn(r,l),onClose:u,hyperlink:!0})}),headerCellClass:l?"metanno-table-header-filter":void 0,headerRenderer:function(n){return(0,o.jsx)(q,fn({},n,{onColumnsReorder:_n,children:jn(n.column)}))},formatter:function(n){var e=n.row,r=n.rowIdx,i=n.column;return(0,o.jsx)(tn,{autocontain:!0,readOnly:!0,hyperlink:!0,onClick:function(n){return null==T?void 0:T(t?e[t]:null,r,i.key,n)},value:e[i.key]})}};case"text":return{editor:e?null:(0,r.forwardRef)(function(n,e){var t=n.row,r=n.column,l=n.rowIdx,a=n.onRowChange,u=n.onClose,s=i().useContext(yn);return(0,o.jsx)(on,{ref:e,row_id:nn(l),inputRef:ln,value:t[r.key],column:r.key,inputValue:v,onInputChange:Cn(l,r),suggestions:void 0===s?c[r.idx].choices:s,onRowChange:a,onClose:u})}),headerCellClass:l?"metanno-table-header-filter":void 0,headerRenderer:function(n){return(0,o.jsx)(q,fn({},n,{onColumnsReorder:_n,children:jn(n.column)}))},formatter:function(n){var e=n.row,t=n.column;return(0,o.jsx)("span",{children:e[t.key]})}};case"multi-text":return{editor:e?null:(0,r.forwardRef)(function(n,e){var t=n.row,r=n.rowIdx,l=n.column,a=n.onRowChange,u=n.onClose,s=i().useContext(yn);return(0,o.jsx)(rn,{ref:e,row_id:nn(r),inputRef:ln,value:t[l.key],column:l.key,inputValue:v,onInputChange:Cn(r,l),suggestions:void 0===s?c[l.idx].choices:s,onRowChange:a,onClose:u})}),headerCellClass:l?"metanno-table-header-filter":void 0,headerRenderer:function(n){return(0,o.jsx)(q,fn({},n,{onColumnsReorder:_n,children:jn(n.column)}))},formatter:function(n){return(0,o.jsx)(tn,fn({autocontain:!0,readOnly:!0},n,{value:n.row[n.column.key]}))}};case"boolean":return{formatter:function(n){var e=n.row,t=(n.rowIdx,n.column),r=n.onRowChange,i=n.isCellSelected;return(0,o.jsx)(pn,{isCellSelected:i,value:e[t.key],onChange:function(n){var o;return r(fn(fn({},e),((o={})[t.key]=n,o)))}})},headerCellClass:l?"metanno-table-header-filter":void 0,headerRenderer:function(n){return(0,o.jsx)(q,fn({},n,{onColumnsReorder:_n,children:jn(n.column)}))}};case"button":return{formatter:function(n){n.row;var e=n.rowIdx,r=n.column;return(0,o.jsx)("button",{onClick:function(){return null==T?void 0:T(t&&null!==e?un.current[e][t]:null,e,r.key)},children:r.key})}};default:return{}}}(n.kind,!n.editable,n.filterable),a=l.formatter,u=l.editor,s=function(n,e){var t={};for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&e.indexOf(o)<0&&(t[o]=n[o]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(n);r<o.length;r++)e.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(n,o[r])&&(t[o[r]]=n[o[r]])}return t}(l,["formatter","editor"]);return(e={})[n.key]=fn(fn(fn({key:n.key,name:n.name,draggable:!0,resizable:!0,editable:!!u,filterable:n.filterable,editorOptions:{commitOnOutsideClick:"hyperlink"!==n.kind&&"multi-hyperlink"!==n.kind}},a?{formatter:a}:{}),u?{editor:u}:{}),s),e}),e=Object.assign.apply(Object,gn([{}],hn(n),!1));return V.map(function(n){return e[n]})},[c,V,v]),Rn=j(function(n){var e=n.map(function(n,e){var t=cn?cn[e]:e;return{oldRow:Sn[e],newRow:n,absRowIdx:t}}).filter(function(n){return n.newRow!==n.oldRow});if(1===e.length){var o=e[0],r=o.newRow,i=o.oldRow,l=o.absRowIdx,a=Object.keys(r).filter(function(n){return r[n]!==i[n]});null==A||A(t?i[t]:null,l,a[0],r[a[0]])}}),In=(0,r.useMemo)(function(){return(0,r.memo)((0,r.forwardRef)(function(n,e){return(0,o.jsx)(F.Row,fn({},n,{ref:e,onMouseEnter:function(e){var o=nn(n.rowIdx);$.current!==o&&(null==y||y(t?un.current[o][t]:null,o,x(e)),null==S||S(t?un.current[o][t]:null,o,x(e)),null!==$.current&&(null==w||w(un.current[$.current][t],$.current,x(e))),$.current=o)},onMouseLeave:function(e){var o=nn(n.rowIdx);setTimeout(function(){$.current===o&&(null==w||w(t?un.current[$.current][t]:null,$.current,x(e)),null==S||S(null,null,x(e)),$.current=null)},50)},className:"metanno-row ".concat(n.className)}))}))},[y,w]),Mn=(0,r.useCallback)(function(n){return(0,o.jsx)(In,fn({},n,{className:t&&(null==O?void 0:O.includes(n.row[t]))?"metanno-row--highlighted":""}))},[O,t]),An=(0,r.useCallback)(function(n){return n[t]},[t]),En=j(function(n){var e,o,r=n.idx,i=n.rowIdx,l=n.mode,a=n.ranges,u=n.cause,s=void 0===u?"key":u,c=null!==i&&i>=0?nn(i):null,d=null!=c&&c>=0,p=null!==r&&r>=0?V[r]:null,f=Array.isArray(a)&&a.length>0?a.map(function(n){return n.rowIdx}):d?[i]:[],h=Array.from(new Set(f.filter(function(n){return n>=0}).map(function(n){return nn(n)}).filter(function(n){return null!=n&&n>=0}))),g=t&&d&&null!==(o=null===(e=un.current[c])||void 0===e?void 0:e[t])&&void 0!==o?o:null,v=h.map(function(n){return{row_idx:n}});null==M||M(g,d?c:null,p,l,s,v),void 0===Q&&U({row_idx:d?c:null,col:p,mode:l,ranges:v})}),Tn=(xn=function(n){if(n){var e=n.row_idx,t=n.col,o=n.mode,r=n.ranges,i=null!=e&&e>=0,l=i?cn?cn.indexOf(e):e:-2,a=Array.isArray(r)&&r.length>0?r.map(function(n){return n.row_idx}):i&&l>=0?[e]:[],u=Array.from(new Set(a.map(function(n){return cn?cn.indexOf(n):n}).filter(function(n){return n>=0})));return{rowIdx:l,idx:t?V.findIndex(function(n){return t===n}):-1,mode:o,ranges:u.map(function(n){return{rowIdx:n}})}}},wn=(0,r.useRef)(null),kn=(0,r.useCallback)(function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=xn.apply(void 0,_([],C(n),!1));return b(t,wn.current)||(wn.current=t),wn.current},[xn]),kn),Pn=j(function(n){if(!n.currentTarget.contains(n.relatedTarget)){var e=void 0!==Q?Q:B;if("EDIT"!==(null==e?void 0:e.mode)&&null!=e){var t=Array.isArray(e.ranges)&&e.ranges.length>0?e.ranges.map(function(n){var e=null==n?void 0:n.row_idx;if(null==e||e<0)return null;var t=cn?cn.indexOf(e):e;return t<0?null:{rowIdx:t}}).filter(function(n){return null!==n}):void 0;En({idx:null,rowIdx:null,mode:"SELECT",cause:"blur",ranges:t})}}}),Nn=j(function(n){var e=n.currentTarget,t=e.scrollTop>an.current,o=e.scrollTop+10>=e.scrollHeight-2*e.clientHeight;if(an.current=e.scrollTop,!W&&o&&t&&E){X(!0);var r=E(n);r instanceof Promise?r.then(function(){return X(!1)}):X(!1)}});(0,r.useEffect)(function(){var n,e;null===(e=(null===(n=ln.current)||void 0===n?void 0:n.input)||ln.current)||void 0===e||e.focus()});var Vn=c.some(function(n){return n.filterable})?65:25,zn=null!==(e=Tn(void 0!==Q?Q:B))&&void 0!==e?e:{rowIdx:-2,idx:-1,mode:"SELECT"};return(0,o.jsx)(yn.Provider,{value:P,children:(0,o.jsx)(mn.Provider,{value:vn,children:(0,o.jsx)("div",{className:"metanno-table",style:R,onBlur:Pn,children:(0,o.jsx)(K.DndProvider,{backend:D.HTML5Backend,children:(0,o.jsx)(F.default,{ref:en,rowKeyGetter:An,rowHeight:25,selection:zn,multiSelectionMode:u,columns:On,rows:Sn,rowRenderer:Mn,headerRowHeight:Vn,onRowsChange:Rn,onSelectionChange:En,onScroll:Nn})})})})})},AnnotatedImage:jn}}}]);